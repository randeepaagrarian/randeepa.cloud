<!DOCTYPE html>
<html>
    <head>
        <% include ./layouts/pro/head %>
    </head>
    <body>
        <div class="wrapper">
            <% include ./layouts/pro/sidebar %>
            <div class="main-panel">
                <% include ./layouts/pro/navbar %>

                <div class="main-content">
                    <div class="container-fluid">


                        <div class="row">

                            <% if(user.accessLevel.sale == 8) { %>

                                <div class="col-md-12">
                                    <div class="card">
                                        <div class="header">
                                            Sales Last 12 Months
                                        </div>
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="header">
                                                        <p class="category">Total Sales</p>
                                                    </div>
                                                    <canvas id="salesLast12Months"></canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-12">
                                    <div class="card">
                                        <div class="header">
                                            Sales This Month
                                        </div>
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="header">

                                                    </div>
                                                    <canvas id="salesThisMonthByRegion"></canvas>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="header">

                                                    </div>
                                                    <canvas id="topOfficersChart"></canvas>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="header">
                                                        <p class="category">By Model</p>
                                                    </div>
                                                    <!-- <div id="salesByModelsChart" class="ct-chart">

                                                    </div> -->
                                                    <div style="margin: 20px;" sclass="table-responsive">
                                                        <table id="salesByModel" class="table table-striped display">
                                                            <thead>
                                                                <tr>
                                                                    <th class="text-center">#</th>
                                                                    <th>Model</th>
                                                                    <th>Sales</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <% for(let i = 0; i < by_models.length; i++) {%>
                                                                    <tr>
                                                                        <td><%= i + 1 %></td>
                                                                        <td><%= by_models[i]['name'] %></td>
                                                                        <td><%= by_models[i]['sales'] %></td>
                                                                    </tr>
                                                                <% } %>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                <div class="header">
                                                    <p class="category">By Officer</p>
                                                </div>
                                                <div style="margin: 20px;" class="table-responsive">
                                                    <table id="salesByOfficer" class="table table-striped display">
                                                        <thead>
                                                            <tr>
                                                                <th class="text-center">#</th>
                                                                <th>Officer</th>
                                                                <th>Region</th>
                                                                <th>Sales</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <% for(let i = 0; i < by_officers.length; i++) {%>
                                                                <tr>
                                                                    <td><%= i + 1 %></td>
                                                                    <td><%= by_officers[i]['name'] %></td>
                                                                    <td><%= by_officers[i]['region_name'] %></td>
                                                                    <td><%= by_officers[i]['sales'] %></td>
                                                                </tr>
                                                            <% } %>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            <% } else { %>

                                <div class="col-md-12">
                                    <div class="card">
                                        <div class="header">
                                            Welcome to new Dashboard
                                        </div>
                                        <div class="content">
                                            <p>This page is still under construction. Once this page is comleted, you will be able to see insights about your performance in the company. In the meantime, please use the side bar on the left side of the screen if you are using a computer or click on the menu icon on the top right hand side corner if you are on a mobile device to access your reports. Have a good day!</p>
                                        </div>
                                    </div>
                                </div>

                            <% } %>

                        </div>



                    </div>
                </div>

                <% include ./layouts/pro/footer %>
            </div>
        </div>
    </body>
    <% include ./layouts/pro/includes %>
    <script type="text/javascript">

        new Chartist.Bar('#topOfficersChart', {
            labels: [
                <% for(let i = 0; i < top_officers.length; i++) { %>
                    "<%= top_officers[i]['name'] %>",
                <% } %>
            ],
            series: [
                <% for(let i = 0; i < top_officers.length; i++) { %>
                    "<%= top_officers[i]['sales'] %>",
                <% } %>
            ]
        }, {
            distributeSeries: true
        });

        var salesLast12Months = new Chart(document.getElementById("salesLast12Months"), {
            type: 'line',
            data: {
                labels: [
                    <% for(let i = 0; i < last_year.length; i++) { %>
                        "<%= last_year[i]['year'] %>-<%= last_year[i]['month'] %>",
                    <% } %>
                ],
                datasets: [{
                    label: 'Sales',
                    data: [
                        <% for(let i = 0; i < last_year.length; i++) { %>
                            "<%= last_year[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(153, 255, 153, 0.2)'
                    ],
                    borderColor: [
                        'rgba(153, 255, 153, 1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'Central',
                    data: [
                        <% for(let i = 0; i < last_year_central.length; i++) { %>
                            "<%= last_year_central[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(102, 163, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(102, 163, 255,1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'Rajarata',
                    data: [
                        <% for(let i = 0; i < last_year_rajarata.length; i++) { %>
                            "<%= last_year_rajarata[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(255, 212, 128, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 212, 128,1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'North-West',
                    data: [
                        <% for(let i = 0; i < last_year_north_west.length; i++) { %>
                            "<%= last_year_north_west[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(51, 255, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(51, 255, 255,1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'Ruhuna',
                    data: [
                        <% for(let i = 0; i < last_year_ruhuna.length; i++) { %>
                            "<%= last_year_ruhuna[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(255, 153, 153, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 153, 153,1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'Industrial',
                    data: [
                        <% for(let i = 0; i < last_year_industrial.length; i++) { %>
                            "<%= last_year_industrial[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(173, 173, 133, 0.2)'
                    ],
                    borderColor: [
                        'rgba(173, 173, 133,1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'North',
                    data: [
                        <% for(let i = 0; i < last_year_north.length; i++) { %>
                            "<%= last_year_north[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
                        'rgba(204, 204, 0, 0.2)'
                    ],
                    borderColor: [
                        'rgba(204, 204, 0,1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero:true
                        }
                    }]
                }
            }
        });

        var salesThisMonthByRegion = new Chart(document.getElementById("salesThisMonthByRegion"), {
            type: 'pie',
            data: {
                labels: [
                    <% for(let i = 0; i < top_regions.length; i++) { %>
                        "<%= top_regions[i]['name'] %>",
                    <% } %>
                ],
                datasets: [{
                    label: 'Sales',
                    data: [
                        <% for(let i = 0; i < top_regions.length; i++) { %>
                            "<%= top_regions[i]['sales'] %>",
                        <% } %>
                    ],
                    backgroundColor: [
						"#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"
					]
                }]
            },
            options: {
              title: {
                display: true,
                text: 'Sales share by region this month'
              }
            }
        });

        new Chart(document.getElementById("topOfficersChart"), {
            type: 'polarArea',
            data: {
              labels: [
                  <% for(let i = 0; i < top_officers.length; i++) { %>
                      "<%= top_officers[i]['name'] %>",
                  <% } %>
              ],
              datasets: [
                {
                  label: "Sales Units",
                  backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
                  data: [
                      <% for(let i = 0; i < top_officers.length; i++) { %>
                          "<%= top_officers[i]['sales'] %>",
                      <% } %>
                  ]
                }
              ]
            },
            options: {
              title: {
                display: true,
                text: 'Top sales by officer this month'
              }
            }
        });

        $(document).ready( function () {
            $('#salesByModel').DataTable();
            $('#salesByOfficer').DataTable();
        } );

	</script>
</html>
